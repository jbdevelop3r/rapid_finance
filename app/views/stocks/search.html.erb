<!-- app/views/stocks/search.html.erb -->
<h1>Stock Symbol Search</h1>

<%= form_with url: search_stocks_path, method: :get, local: true do |form| %>
  <%= form.label :keywords, "Enter company name or keywords" %>
  <%= form.text_field :keywords, required: true %>
  <%= form.submit "Search Symbols" %>
<% end %>

<% if @search_results.present? && @search_results["bestMatches"] %>
  <h2>Results:</h2>
  <table>
    <thead>
      <tr>
        <th>Symbol</th>
        <th>Name</th>
        <th>Type</th>
        <th>Region</th>
      </tr>
    </thead>
    <tbody>
      <% @search_results["bestMatches"].each do |match| %>
        <tr>
          <td><%= match["1. symbol"] %></td>
          <td><%= match["2. name"] %></td>
          <td><%= match["3. type"] %></td>
          <td><%= match["4. region"] %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% elsif @search_results.is_a?(Hash) && @search_results["error"] %>
  <p style="color: red;">Error: <%= @search_results["error"] %></p>
<% end %>
